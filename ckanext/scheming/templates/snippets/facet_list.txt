{% import 'macros/form.html' as form %}

<!-- Koko -->
{% block facet_list %}
{% set hide_empty = hide_empty or false %}
{% with items = items or h.get_facet_items_dict(name, search_facets or c.search_facets) %}
{% if items or not hide_empty %}
{% if within_tertiary %}
{% set nav_class = 'nav nav-pills nav-stacked' %}
{% set nav_item_class = ' ' %}
{% set wrapper_class = 'nav-facet nav-facet-tertiary' %}
{% endif %}
<!-- KOKO -->
{% if 'level' not in title %}
{% block facet_list_item %}
<section class="{{ wrapper_class or 'module module-narrow module-shallow' }}">
    {% block facet_list_heading %}
    <h2 class="module-heading">
        <i class="fa fa-filter"></i>
        {% set title = title or h.get_facet_title(name) %}
        {{ title }}
    </h2>
    {% endblock %}
    {% block facet_list_items %}
    {% with items = items or h.get_facet_items_dict(name, search_facets or c.search_facets) %}
    {% if items %}
    <nav aria-label="{{ title }}">
        <ul class="{{ nav_class or 'list-unstyled nav nav-simple nav-facet' }}">
            {% for item in items %}
            {% set href = h.remove_url_param(name, item.name, extras=extras, alternative_url=alternative_url) if
            item.active else h.add_url_param(new_params={name: item.name}, extras=extras,
            alternative_url=alternative_url) %}
            {% set label = label_function(item) if label_function else item.display_name %}
            {% set label_truncated = h.truncate(label, 22) if not label_function else label %}
            {% set count = count_label(item['count']) if count_label else ('%d' % item['count']) %}
            <li class="{{ nav_item_class or 'nav-item' }}{% if item.active %} active{% endif %}">
                <a href="{{ href }}" title="{{ label if label != label_truncated else '' }}">
                    <span class="item-label">{{ label_truncated }}</span>
                    <span class="hidden separator"> - </span>
                    <span class="item-count badge">{{ count }}</span>
                </a>
            </li>
            {% endfor %}
        </ul>
    </nav>

    <p class="module-footer">
        {% if h.get_param_int('_%s_limit' % name) %}
        {% if h.has_more_facets(name, search_facets or c.search_facets) %}
        <a href="{{ h.remove_url_param('_%s_limit' % name, replace=0, extras=extras, alternative_url=alternative_url) }}"
            class="read-more">{{ _('Show More {facet_type}').format(facet_type=title) }}</a>
        {% endif %}
        {% else %}
        <a href="{{ h.remove_url_param('_%s_limit' % name, extras=extras, alternative_url=alternative_url) }}"
            class="read-more">{{ _('Show Only Popular {facet_type}').format(facet_type=title) }}</a>
        {% endif %}
    </p>
    {% else %}
    <p class="module-content empty">{{ _('There are no {facet_type} that match this search').format(facet_type=title) }}
    </p>
    {% endif %}
    {% endwith %}
    {% endblock %}
</section>
{% endblock %}
<!-- KOKO -->
{% else %}
{% if 'level0' == title %}
<!-- Hier kommt gerade: -->


<div class="filters">
    <div>
        <section class="module module-narrow module-shallow">
            <h2 class="module-heading">
                <i class="fa fa-filter"></i>
                Levels
            </h2>
            <nav aria-label="Koko" id="level_21">
                <!-- <ul class="list-unstyled nav nav-simple nav-facet"> -->
                <ul>
                    <!-- Das muss ich noch mal ersetzen durch die richtigen Daten -->
                    {{ field }}
                    {% set fielda = {"deutschland": {"niedersachsen": ["braunschweig"],"sachsen": ["dresden"]},"svergie": {"Dalarna": ["Mora","Åre"],"Gävleborg": ["Gävle"],"Östergötland": ["Vadstena"]}} %}
                    {%- for key, value in fielda.items() recursive %}
                    <details>
                        <summary>
                            <li>
                                {{ facet_list_items }}
                                <!-- class="nav-item" -->
                                <a class="nav-item" href="?level0={{ key }}" title="">
                                    <span class="item-label">{{ key }}</span>
                                    <span class="hidden separator"> - </span>
                                    <span class="item-count badge">7</span>
                                </a>
                            </li>
                        </summary>
                        {%- if value is mapping %}
                        <!-- class="list-unstyled nav nav-simple nav-facet" -->
                        <ul>{{ loop(value.items()) }}</ul>
                        {% else %}
                        <!-- class="list-unstyled nav nav-simple nav-facet" -->
                        <ul>
                            {% for v in value %}
                            <li>
                                <a class="nav-item" href="?level{{ v }}">
                                    <span class="item-label">{{ v }}</span>
                                    <span class="hidden separator"> - </span>
                                    <span class="item-count badge">6</span>
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                        {%- endif %}
                    </details>
                    {%- endfor %}
                </ul>
            </nav>
        </section>
    </div>
</div>
<style>
    summary {
        position: relative;
        list-style: circle;
    }
    details {
        color:#A5B65A;
    }
    details[open]{
        color:#489CD4;
    }
    /* .nav-item{
        display: block;
        padding: 10px 0px;
    } */

</style>



{#% snippet "package/snippets/testen_baum.html" %#}
{% endif %}

<!-- KOKO -->
{% endif %}
{% endif %}
{% endwith %}
{% endblock %}